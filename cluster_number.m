
function N = cluster_number(R)
%when given a value of R, calculate the number of clusters
%to evaluate the quality of the clustering and select the best parameter R

%load the features value
%features=[[0.295192938789701,0.370633523439578,-0.407056934020723]; [0.554220752302760,-0.459211855017436,-0.406544805747439]; [-0.111505000752107,1.67085577420493,-0.407021024654544]; [0.554109867267375,-0.459248342841509,-0.406423612818804]; [0.554362232707440,-0.459131154003178,-0.406710080477890]; [0.554501302567874,-0.458818934178084,-0.406944001560981]; [-2.10202053546224,-0.457379464594619,2.22291936100420]; [0.554377066825887,-0.459118044663811,-0.406728818383544]; [0.541851322636399,-0.417588377354615,-0.407187284806145]; [0.554500931714912,-0.458821567299696,-0.406942983575593]; [-0.516227035716883,2.96492155845395,-0.407034295757689]; [0.554464217271758,-0.458990450350683,-0.406854449550967]; [0.554454575094768,-0.459011815845452,-0.406838523823782]; [-2.54228263524764,-0.459090849949385,2.65936745417390]];
features=[0.639206767082214,0.360776782035827,1.64123030117480e-05;0.0527163855731487,1.13780069810331e-08,0.947283565998077;0.510355710983276,0.489636212587356,8.08259574114345e-06;0.00371538451872766,4.12392064941258e-11,0.996284604072570;0.344004392623901,8.71559052484371e-07,0.655994713306427;0.911844193935394,6.10696224612183e-05,0.0880947709083557;0.00371235655620694,4.11685963097596e-11,0.996287584304809;0.399177610874176,1.31135652736702e-06,0.600821077823638;0.928544342517852,0.0713089480996131,0.000146660226164385;0.910731554031372,6.00789062445983e-05,0.0892084687948226;0.437839001417160,0.562155663967132,5.31788418811629e-06;0.762697398662567,1.41455047923955e-05,0.237288400530815;0.724316596984863,1.07666091935243e-05,0.275672614574432;0.00371067505329847,4.11294297231190e-11,0.996289372444152];
r=R;
nn = 1; %the current number of clusters let test1 to be cluster1

for i=2:14
    coor=features(i,1:3);
     n=i-1;
    for j=1:n
        if(norm(coor-features(j,1:3))>2*r)
            %testi and testj are not overlapping (note that j<i)
            n=n-1;
        end
    end
    
    if n==0
        %imply that testi is a new cluster
        nn = nn+1;
    end
end

N=nn; %the final number of clusters
end

